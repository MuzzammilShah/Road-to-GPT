
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../executed-starter-code/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Lecture Notes - Road to AI</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%202C6.47%202%202%206.47%202%2012s4.47%2010%2010%2010%2010-4.47%2010-10S17.53%202%2012%202m3.1%205.07c.14%200%20.28.05.4.16l1.27%201.27c.23.22.23.57%200%20.78l-1%201-2.05-2.05%201-1c.1-.11.24-.16.38-.16m-1.97%201.74%202.06%202.06-6.06%206.06H7.07v-2.06z%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M13%2014h-2V9h2m0%209h-2v-2h2M1%2021h22L12%202z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M13%2013h-2V7h2m0%2010h-2v-2h2M12%202A10%2010%200%200%200%202%2012a10%2010%200%200%200%2010%2010%2010%2010%200%200%200%2010-10A10%2010%200%200%200%2012%202%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#set-a-lecture-notes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Road to AI" class="md-header__button md-logo" aria-label="Road to AI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M10.628 7.25a2.25 2.25 0 1 1 0 1.5H8.622a2.25 2.25 0 0 1-2.513 1.466L5.03 12.124a2.25 2.25 0 1 1-1.262-.814l1.035-1.832A2.25 2.25 0 0 1 4.25 8c0-.566.209-1.082.553-1.478L3.768 4.69a2.25 2.25 0 1 1 1.262-.814l1.079 1.908A2.25 2.25 0 0 1 8.622 7.25ZM2.5 2.5a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0m4 4.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5m6.25 0a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5m-9.5 5.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Road to AI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lecture Notes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  Neural Networks

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Road to AI" class="md-nav__button md-logo" aria-label="Road to AI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M10.628 7.25a2.25 2.25 0 1 1 0 1.5H8.622a2.25 2.25 0 0 1-2.513 1.466L5.03 12.124a2.25 2.25 0 1 1-1.262-.814l1.035-1.832A2.25 2.25 0 0 1 4.25 8c0-.566.209-1.082.553-1.478L3.768 4.69a2.25 2.25 0 1 1 1.262-.814l1.079 1.908A2.25 2.25 0 0 1 8.622 7.25ZM2.5 2.5a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0m4 4.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5m6.25 0a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5m-9.5 5.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5"/></svg>

    </a>
    Road to AI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Neural Networks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Neural Networks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zero to Hero Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Backpropagation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Backpropagation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Micrograd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Lecture Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notes/A-main-video-lecture-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Master Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notes/micrograd-functionality/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Micrograd Functionality
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notes/value-object-creation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Value Object Creation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notes/crux-node-backpropagation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crux Node Backpropagation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notes/neurons-explaination/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neurons Explaination
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notes/expanding-tanh-and-adding-more-operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expanding tanh and adding more operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notes/pytorch-comparision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notes/multi-layer-perceptron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Layer Perceptron
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/1-derivative-simple-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Derivative Simple Function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/2-derivative-function-with-multiple-inputs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Derivative Function with Multiple Inputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/3_1-graph-visualisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graph Visualisation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/3-value-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Value Object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/4_0_manual_backpropagation_simpleExpression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manual Backpropagation-0
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/4_1_manual_backpropagation_simpleExpression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manual Backpropagation-1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/4_2_manual_backpropagation_simpleExpression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manual Backpropagation-2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/5_optimization_single_step_preview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimization Single Step Preview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/6_0_backpropagation_neuron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backpropagation Neuron
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/6_1_backpropagation_neuron_manual_calculation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backpropagation Neuron - Manual Calculation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/7_0_backward_func_each_operation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backward Function - Each operation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/7_1_backward_func_entire_graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backward Function - Entire Graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/8_handling_onenode_used_multiple_times/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Handing one node used multiple times
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/9_expanding_tanh_into_more_operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expanding tanh into more operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/x10_implementing_in_pytorch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementing in PyTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/x11_creating_a_multi_layer_perceptron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a MLP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/x12_creating_a_loss_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a Loss function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/x13_collecting_all_parameters_in_NN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collecting all parameters in Neural Net
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Micrograd/notebooks/x14_manual_gradient_descent_optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manual Gradient Descent Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Language Model-1
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Language Model-1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Makemore Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Set A
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Set A
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part1/A-main-makemore-part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part1/A-Main-Notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Set B
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            Set B
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part1/B-main-makemore-part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part1/B-Main-Notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Set C
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            Set C
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part1/C-main-makemore-part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part1/C-Main-Notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Language Model-2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Language Model-2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Makemore Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Set A
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            Set A
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part2/A-main-makemore-part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part2/A-main-notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Set B
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            Set B
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part2/B-main-makemore-part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part2/B-main-notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4_4" id="__nav_2_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Set C
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            Set C
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part2/C-main-makemore-part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part2/C-main-notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Language Model-3
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Language Model-3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Makemore Part 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_5_2" id="__nav_2_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes and Codes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5_2">
            <span class="md-nav__icon md-icon"></span>
            Notes and Codes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starter-code" class="md-nav__link">
    <span class="md-ellipsis">
      Starter code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixing-the-initial-loss" class="md-nav__link">
    <span class="md-ellipsis">
      Fixing the initial loss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixing-the-saturated-tanh" class="md-nav__link">
    <span class="md-ellipsis">
      Fixing the saturated tanh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculating-the-init-scale-kaiming-init" class="md-nav__link">
    <span class="md-ellipsis">
      Calculating the init scale: “Kaiming init”
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batch-normalization" class="md-nav__link">
    <span class="md-ellipsis">
      Batch normalization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batch-normalization-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Batch normalization: summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-example-resnet50-walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      Real example: resnet50 walkthrough
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-the-lecture" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of the lecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../executed-starter-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starter Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A-main-notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualization Code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Language Model-4
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Language Model-4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Makemore Part 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_2" >
        
          
          <label class="md-nav__link" for="__nav_2_6_2" id="__nav_2_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes and Codes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            Notes and Codes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part4/exercise-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercise 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part4/exercise-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercise 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part4/exercise-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercise 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part4/final-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Final code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Language Model-5
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Language Model-5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Makemore Part 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_2" >
        
          
          <label class="md-nav__link" for="__nav_2_7_2" id="__nav_2_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes and Codes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_2">
            <span class="md-nav__icon md-icon"></span>
            Notes and Codes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part5/Main-makemore-part-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Makemore-part5/Main-notebook-part-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    GPT-1
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            GPT-1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GPT-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer Model-1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8_2" >
        
          
          <label class="md-nav__link" for="__nav_2_8_2" id="__nav_2_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Codes Implemented
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_2">
            <span class="md-nav__icon md-icon"></span>
            Codes Implemented
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GPT-1/gpt-dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notebook Implemented
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GPT-1/bigram/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bigram Script Breakdown
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="">
            
  
  <span class="md-ellipsis">
    GPT-2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            GPT-2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GPT-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer Model-2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="">
            
  
  <span class="md-ellipsis">
    GPT-Tokenizer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            GPT-Tokenizer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GPT-Tokenizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tokenizer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="">
            
  
  <span class="md-ellipsis">
    General MISC
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            General MISC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../General-MISC/intro-llms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to LLMs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../General-MISC/deepdive-llms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep Dive into LLMs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../General-MISC/using-llms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using LLMs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starter-code" class="md-nav__link">
    <span class="md-ellipsis">
      Starter code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixing-the-initial-loss" class="md-nav__link">
    <span class="md-ellipsis">
      Fixing the initial loss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixing-the-saturated-tanh" class="md-nav__link">
    <span class="md-ellipsis">
      Fixing the saturated tanh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculating-the-init-scale-kaiming-init" class="md-nav__link">
    <span class="md-ellipsis">
      Calculating the init scale: “Kaiming init”
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batch-normalization" class="md-nav__link">
    <span class="md-ellipsis">
      Batch normalization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batch-normalization-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Batch normalization: summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-example-resnet50-walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      Real example: resnet50 walkthrough
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-the-lecture" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of the lecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="set-a-lecture-notes">SET A - LECTURE NOTES<a class="headerlink" href="#set-a-lecture-notes" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-000000"><strong>Timestamp</strong>: <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=0s">00:00:00</a><a class="headerlink" href="#timestamp-000000" title="Permanent link">&para;</a></h4>
<p>We'll be continuing with our implementation of Makemore. Now, we'll obviously like to move forward from the previous implementation to slightly more advanced implementations like RNN, GRU, Transformer etc. </p>
<p>But we will be sticking around with MLP itself right now. The purpose of this is to have an intuitive understanding of the activations in the NN during training and especially the gradients that are falling backwards - how they behave and what they look like.</p>
<p>So it is going to be very important to understand the history of the development of these architectures (RNN, GRU etc.). The reason is, RNN while they are very expressive, is the universal approximator and in principle can implement all the algorithms; we will see that they are not very easily optimizable with the first order gradient techniques we have available to us and that we use all the time.</p>
<p>And the key to understanding why they are not optimizable so easily, is to understand the activations, the gradients and how they behave during training (And apparently it is also seen that all the variants after RNN have tried to improve that situation).</p>
<p>So that is what we will be focusing on.</p>
<p>&nbsp;</p>
<h2 id="starter-code">Starter code<a class="headerlink" href="#starter-code" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-000122"><strong>Timestamp:</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=82s">00:01:22</a><a class="headerlink" href="#timestamp-000122" title="Permanent link">&para;</a></h4>
<p>Cleaned up code from Makemore Part 2 with some fixes. Will be starting from there, provided a starter code along with revision explanations, so go through that. You can find the code <a href="../executed-starter-code/">here</a></p>
<p>&nbsp;</p>
<h2 id="fixing-the-initial-loss">Fixing the initial loss<a class="headerlink" href="#fixing-the-initial-loss" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-000419"><strong>Timestamp:</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=259s">00:04:19</a><a class="headerlink" href="#timestamp-000419" title="Permanent link">&para;</a></h4>
<p>Now the first thing we would like to point out is the initialization. We can tell that there is multiple things that is wrong with our neural network especially at initialization, but lets start with the first one.</p>
<p>In the zeroth iteration, our loss value is way too high. And as it moves to the next iteration the loss value comes down even more significantly. Now, usually during the training of the neural net we can almost always expect what our initial loss/loss value is going to be. And we can also calculate it in our case:</p>
<p>At the start we basically expect it to record a constant/standard normal distribution as there can be only one possibility from 27 characters. So we consider that and then take the negative log likelihood <code>-torch.tensor(1/27.0).log()</code> 
Then we can see that the loss value is a lot lower and is what we expect.</p>
<p>Why this is happening is because, at the start the model/NN is 'confidently wrong'. So for some it records very high confidence and for some very low confidence.</p>
<p>So how do we resolve this,
we notice that the logits for the zeroth iteration are very high and we need them to be close to zero.
and logits are calculated based on <code>logits = h @ W2 + b2</code>
So we try to multiply the W2 and b2 values with values very close to zero.</p>
<p>We added the values 0.01 and 0 to the W2 and b2 values (avoid adding 0 directly, although for this example multiplying it with 0 to the output layer might just be fine, but don't normally do it)</p>
<p>So we finally see that, the initial loss value has been controlled and the graph output doesn't have that 'hockey stick' appearance. And the Train evaluation value was also reduced from 2.12 to 2.06</p>
<p>This happened because we actually spent time optimizing the NN rather than just spending the initial several thousand iterations just squashing the weights and then optimizing it. </p>
<p>So that was the Number 1 issue fix.</p>
<p>&nbsp;</p>
<h2 id="fixing-the-saturated-tanh">Fixing the saturated tanh<a class="headerlink" href="#fixing-the-saturated-tanh" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-001259"><strong>Timestamp:</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=779s">00:12:59</a><a class="headerlink" href="#timestamp-001259" title="Permanent link">&para;</a></h4>
<details class="note">
<summary>Note</summary>
<p>This section will contain different code snippets which won't be present in the final implementation notebook, That is because these were used for just explaination purposes. For better understanding, copy the snippets, add it to the code to see how the outputs will turn out.</p>
</details>
<p>Now, lets look at the Second problem. Although we were able to fix the initial loss there is still another problem lingering within this neural net. </p>
<p>We have fixed the logits values, the problem now is with the <code>h</code> values - the activations of the hidden states.
Lets see how the value distributions are for the activation function, you can depict those using a histogram:</p>
<div class="highlight"><pre><span></span><code>plt.hist(h.view(-1).tolist(), 50)
</code></pre></div>
<div class="highlight"><pre><span></span><code>plt.hist(hpreact.view(-1).tolist(), 50)
</code></pre></div>
<p>In the first code you would see that the values would be active at 1 and -1 (tanh is being a play here) and in the second code, if we look at the 'h pre activation' values <code>hpreact</code> that we feed into the tanh, the distribution of the preactivations is very very broad.</p>
<p><em>Now this may not really look like an issue and that is coz we are (I am) still a beginner in Neural Nets :)</em> So, Watch these sections of the timestamps for a better visual understanding of the issue:</p>
<ul>
<li>
<p><a href="https://youtu.be/P6sfmUTpUmc?si=juvbk3pYS3cyCEC0&amp;t=916">15:16</a> to 18:20 : Diving into the backpropagation process, especially in the tanh layer. He dives into what happens in tanh during the backward pass. So the concern here is that, if all of the outputs of <code>h</code> are in the flat regions of -1 and 1, then the gradients that are just flowing though the network would just get destroyed.</p>
</li>
<li>
<p><a href="https://youtu.be/P6sfmUTpUmc?si=2wtrd2nHF8axm5C3&amp;t=1101">18:21</a> to 20:35: A figure has been generated to see how much of the <code>h</code> values have been flattened in the tanh layer. It is a boolean expression graph, where if the condition is true it will be represented in white dots.
     <div class="highlight"><pre><span></span><code>plt.figure(figsize=(20,10))
plt.imshow(h.abs() &gt; 0.99, cmap=&#39;gray&#39;, interpolation=&#39;nearest&#39;)
</code></pre></div>
    Now, if there was a column that was completely whites, then we have something what we call the 'dead neuron'. It means it never fell within the active part of the tanh i.e. the curve area between -1 and 1. And if any of the values fall in the flat regions (end points) i.e. at the -1 and 1, then that means the neuron will never learn and it is a dead neuron (so now you know why it was an issue there :) )</p>
</li>
<li>
<p><a href="https://youtu.be/P6sfmUTpUmc?si=SdmX7xbbV6rbOtl1&amp;t=1236">20:36</a> to 23:23 : Behaviors of different types of Activation functions.</p>
</li>
<li>
<p><a href="https://youtu.be/P6sfmUTpUmc?si=SdmX7xbbV6rbOtl1&amp;t=1236">23:24</a> to 25:53: Back to the black and white figure graph where we take the measures to resolve the issue of dead neurons.
    So now, <code>hpreact</code> comes from <code>embcat</code> which comes from <code>C[Xb]</code> so these are uniform Gaussian, which are then multiplied and added with the weights and bias.
    The <code>hpreact</code> values is right now way off zero and we want its values to be closer to zero. So therefore like how we did with logits, we modify the values of the W1 and b1 during the NN values initialization.
    We have multiplied those values with values close to zero like <code>0.01</code> for b1 and <code>0.1</code> for W1, and we noticed that there are no values in the flat regions of the tanh layer therefore no white spots which is great. For example purposes, we increase the values for W1 by multiplying it with <code>0.2</code> instead so that we can see some white spots.</p>
</li>
</ul>
<details class="note">
<summary>Note</summary>
<p>Use the code snippets provided within this lecture timestamp.</p>
</details>
<p>So now we have improved the loss value a lot further. This is basically illustrating initialization and its impact on performance, just by being aware of the internals of the NN of its activations and gradients.</p>
<p>Lastly, the purpose of those 2 explanations is that, right now we are only working with a single MLP. Now as we get a bigger NN and there are more depths into the neurons, these initializations errors can cause us a lot of problems and we may even come to a case where the NN doesn't train at all. So we must be very aware of this.</p>
<p>&nbsp;</p>
<h2 id="calculating-the-init-scale-kaiming-init">Calculating the init scale: “Kaiming init”<a class="headerlink" href="#calculating-the-init-scale-kaiming-init" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-002753"><strong>Timestamp:</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=1673s">00:27:53</a><a class="headerlink" href="#timestamp-002753" title="Permanent link">&para;</a></h4>
<p>In our code till now, during the initialization of the Neural Network, we have been hardcoding the value/adding magic numbers to optimize the initial value. But we need to ensure that we follow a more dynamic approach.
<div class="highlight"><pre><span></span><code>g = torch.Generator().manual_seed(2147483647)
C  = torch.randn((vocab_size, n_embd),            generator=g)
W1 = torch.randn((n_embd * block_size, n_hidden), generator=g) * 0.2 #here
b1 = torch.randn(n_hidden,                        generator=g) * 0.01
W2 = torch.randn((n_hidden, vocab_size),          generator=g) * 0.01
b2 = torch.randn(vocab_size,                      generator=g) * 0
</code></pre></div></p>
<p>Upto 35:56 we have covered as to why that needs to be done (How activation function actually squash the values and how optimizing the initial values helps with the help of histogram) along with that we were also shown a <a href="https://arxiv.org/pdf/1502.01852">research paper</a> by Kaiming He which illustrates how we can perform such calculation of numbers during initialization. </p>
<p>So in the paper he suggests to do a square root of 2/fin (fin is the input value). The square root of fin is there, the 2 was added because in their paper they considered ReLU as the activation function, so in that the values get squashed to half and then optimised. So in order to balance that they added 2 -&gt; <code>√2/nl</code></p>
<p>Now, this kaiming implementation is also done in <a href="https://pytorch.org/docs/stable/nn.init.html#torch.nn.init.kaiming_normal_">PyTorch called 'Kaiming normal'</a> which can be used as well.</p>
<details class="note">
<summary>Note</summary>
<p>Go through till that part of the timestamp for a getting a more intuitive understanding, it was more of an explanation backup to show why we are doing what we are doing in the next steps.</p>
</details>
<p>From <a href="https://youtu.be/P6sfmUTpUmc?si=jhlIF3fUDsZBw-MU&amp;t=2157">35:57</a>:
Now, back then when the above paper was released about 7 years ago, we had to be very careful about how we initialize the values for these input values of the NN. But now we have more modern innovations that handle this way better, which include:
- Residual Connection (Which we will cover in later videos)
- Use of different Normalization layers- Batch Normalization. Layer Normalization, Group Normalization
- Much better Optimizers- Not just stochastic gradient descent the simple optimizer that we have bee using here, but slightly more complex optimizers like RMS prop and Adam(Adaptive Moment Estimation).
So all these modern innovations make it much less necessary for us to precisely calculate the initialization of the neural net.</p>
<p>The method which Andrej uses is dividing the initial value with the square root of the fin.</p>
<p>As for our code in this, we will be doing the "Kaiming init" itself, provided by PyTorch. Now they have also mentioned a certain gain value which must be added on the numerator depending on the activation function used, <a href="https://pytorch.org/docs/stable/nn.init.html#torch.nn.init.calculate_gain">as mentioned here</a>. So in our case its tanh, so we use <code>5/3</code>, divide with the square root of the fin. So finally that would be:
<code>W1 = torch.randn((n_embd * block_size, n_hidden), generator=g) * (5/3) / ((n_embd * block_size)**0.5)</code>
instead of directly multiplying with a magic number which we predicted from looking at the histogram graphs.</p>
<p>This approach is a lot better and will help us as we scale our NN and becomes much larger.</p>
<p>&nbsp;</p>
<h2 id="batch-normalization">Batch normalization<a class="headerlink" href="#batch-normalization" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-004040"><strong>Timestamp:</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=2440s">00:40:40</a><a class="headerlink" href="#timestamp-004040" title="Permanent link">&para;</a></h4>
<p>Showed the paper which actually introduced the concept of batch normalization, researched by a team at google - <a href="https://arxiv.org/pdf/1502.03167">Research paper</a> and the idea of the concept which it explained.</p>
<p>From <a href="https://youtu.be/P6sfmUTpUmc?si=zQKb_RmYEtbIcJnl&amp;t=2536">42:16</a> -&gt; Implemented the batch normalization step into the code (How and what needs to be done based on the paper)</p>
<p>We will work on the pre-activation value <code>hpreact</code> just before they enter the tanh layer. These are already almost gaussian (because 1. if it is too small then tanh will have no effect on it and if it is too large then tanh will become to saturated, 2. this is just a single layer NN, but as it gets complex this is where we will be adding it)</p>
<p>Now, we will be considering one batch, in this case the 0th column and calculate its mean and standard deviation.
<div class="highlight"><pre><span></span><code>hpreact.mean(0, keepdim=True).shape
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>hpreact.std(0, keepdim=True).shape
</code></pre></div>
<p>Now we perform the batch normalization on <code>hpreact</code> and make the values roughly gaussian.
<div class="highlight"><pre><span></span><code>hpreact = (hpreact - hpreact.mean(0, keepdim=True)) / (hpreact.std(0, keepdim=True))
</code></pre></div>
So we subtract with the mean and divide with its standard deviation.</p>
<p>Now, if we train the NN after doing this, we wont exactly get a good loss value. First of all, we don't want it to force it to be gaussian for all values, we need it just for the first value. Apart from that, we want it to spread around so that the values fed into the tanh has mixed reactions - some of them would trigger it, some may saturate it. </p>
<p>So we introduce another concept from the paper called 'Scale and Shift'
What we do is, take the normalized input and we are scaling it with some <strong>gain</strong> and offsetting with some <strong>bias</strong>, to get our final output from the layer (See page 2, right bottom box in the batch norm paper)</p>
<p>Now we add those values
<div class="highlight"><pre><span></span><code>bngain = torch.ones((1, n_hidden))
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>bnbias = torch.zeros((1, n_hidden))
</code></pre></div>
<p>So we add these to the batch norm layer
<div class="highlight"><pre><span></span><code>hpreact = bngain * (hpreact - hpreact.mean(0, keepdim=True)) / (hpreact.std(0, keepdim=True)) + bnbias
</code></pre></div>
Exactly as in the paper, multiply the gain value and add the bias.</p>
<p>Then, we add them to the parameters of the NN as they will be trained during backpropagation.
<code>parameters = [C, W1, b1, W2, b2]</code> to <code>parameters = [C, W1, b1, W2, b2, bngain, bnbias]</code></p>
<p>(We add that batch norm layer^ for the validation set of code as well)</p>
<p>In bigger NN, we usually recognize the single layer or the convolution layers and add the batch norm just after this to control the scale of these activations at every point of this NN. So it significantly stabilizes the training and that is why they are so popular.</p>
<p>From <a href="https://youtu.be/P6sfmUTpUmc?si=1mEMNcSCfctjXnxW&amp;t=3015">50:15</a> to 53:48 -&gt; The Story of Batch Normalization of how it acts as a regulariser, so it works for some training(very few cases) and how many people are trying to move away from it to other normalization techniques.</p>
<p>From <a href="https://youtu.be/P6sfmUTpUmc?si=Z-zzIOkOSAQW8OsD&amp;t=3244">54:04</a> -&gt; 
Modifications to the code (the validation part), where it can handle cases where if only a single input is fed (as now it expects values in batches) -&gt; after that update again to make sure it is in a loop</p>
<ul>
<li>So in order to fix that, we have calculated the mean and standard deviation, so they are now fixed values of the tensors which are now passed:</li>
</ul>
<div class="highlight"><pre><span></span><code># calibrate the batch norm at the end of training

with torch.no_grad():
  # pass the training set through
  emb = C[Xtr]
  embcat = emb.view(emb.shape[0], -1)
  hpreact = embcat @ W1 # + b1
  # measure the mean/std over the entire training set
  bnmean = hpreact.mean(0, keepdim=True)
  bnstd = hpreact.std(0, keepdim=True)
</code></pre></div>
<div class="highlight"><pre><span></span><code>@torch.no_grad()
def split_loss(split):

  x,y = {
    &#39;train&#39;: (Xtr, Ytr),
    &#39;val&#39;: (Xdev, Ydev),
    &#39;test&#39;: (Xte, Yte),
  }[split]
  
  emb = C[x] # (N, block_size, n_embd)
  embcat = emb.view(emb.shape[0], -1)
  hpreact = embcat @ W1 + b1
  hpreact = bngain * (hpreact - hpreact.mean(0, keepdim=True)) / (hpreact.std(0, keepdim=True)) + bnbias #this is removed
  hpreact = bngain * (hpreact - bnmean) / bnstd + bnbias #and updated to this
  h = torch.tanh(hpreact) 
  logits = h @ W2 + b2
  loss = F.cross_entropy(logits, y)
  print(split, loss.item())

split_loss(&#39;train&#39;)
split_loss(&#39;val&#39;)
</code></pre></div>
<ul>
<li>
<p>Contd from <a href="https://youtu.be/P6sfmUTpUmc?si=T30lB2x6Y6GCh6VG&amp;t=3358">56:24</a>till 59:58 (Recommend to watch this part of the timestamp again) Now nobody wants to estimate the mean and standard deviation in the second stage i.e. having made a neural net. So the paper itself provides another method (the mean and std idea was received from the paper as well), where we add like a running state. So the moment the first stage of making NN is done, it automatically comes to this. </p>
<p>So instead of adding this in the validation part of the code, we are going to add this in the training time itself. That way we are kind of creating this side job which does this work simultaneously for both training and val sets and we don't need that new block of code which we had added^</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code># BatchNorm parameters
bngain = torch.ones((1, n_hidden))
bnbias = torch.zeros((1, n_hidden))
bnmean_running = torch.zeros((1, n_hidden))
bnstd_running = torch.ones((1, n_hidden))

parameters = [C, W1, W2, b2, bngain, bnbias]
</code></pre></div>
<div class="highlight"><pre><span></span><code># BatchNorm layer
bnmeani = hpreact.mean(0, keepdim=True)
bnstdi = hpreact.std(0, keepdim=True)

hpreact = bngain * (hpreact - bnmeani) / bnstdi + bnbias

with torch.no_grad():
    bnmean_running = 0.999 * bnmean_running + 0.001 * bnmeani
    bnstd_running = 0.999 * bnstd_running + 0.001 * bnstdi
</code></pre></div>
<p>So if you run <code>bnmean</code> and <code>bnmean_running</code> | <code>bnstd</code> and <code>bnstd_running</code> (haven't removed the new code which we added before the val code chunk yet) you would see that they are very similar, not identical but similar.</p>
<p>From <a href="https://youtu.be/P6sfmUTpUmc?si=8Qm1HWAj77cIMKAR&amp;t=3655">1:00:55</a>-&gt; 2 more notes:
1. In the paper, in the box explanation with the formulas, under <code>//normalise</code> we see an epsilon (ϵ), that in added there so that it essentially avoids a divide by zero. We haven't done that in our code because it won't really be necessary as our example is too small.
2. The <code>b1</code> that we add in the <code>hpreact</code> is pretty useless right now. Because in the batch norm we are already adding the bias <code>bnbias</code> and also before that subtracting the value of <code>hpreact</code> with <code>bnmean</code>. So essentially, in batch norm we are adding our own bias. <em>So during the first addition of weights in the NN and if you are performing Batch norm, you don't have to add the bias, so you can just comment it out</em> (Its not really having a catastrophic effect if you keep it, but we know its not really doing anything in our code so we just drop it).</p>
<p>&nbsp;</p>
<h2 id="batch-normalization-summary">Batch normalization: summary<a class="headerlink" href="#batch-normalization-summary" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-010307"><strong>Timestamp:</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=3787s">01:03:07</a><a class="headerlink" href="#timestamp-010307" title="Permanent link">&para;</a></h4>
<p>(Useful for a quick yet detailed recap)</p>
<ul>
<li>We are using batch normalization to control the statistics of activations in the neural net.</li>
<li>It is common to sprinkle the batch normalization layer across the neural net, and usually we place it after layers that have multiplications. Like a linear layer or Convolutional layer.</li>
<li>
<p>From <a href="https://youtu.be/P6sfmUTpUmc?si=KhnrWq9AZcLFsQRg&amp;t=3813">1:03:33</a> -&gt; Explanation of the different variables in the code.</p>
<ul>
<li>
<p>Batch norm internally has parameters for the gain and the bias, that are trained using backpropagation.
<div class="highlight"><pre><span></span><code>bngain = torch.ones((1, n_hidden))
bnbias = torch.zeros((1, n_hidden))
</code></pre></div></p>
</li>
<li>
<p>It also has two buffers: running mean and running std.
<div class="highlight"><pre><span></span><code>bnmean_running = torch.zeros((1, n_hidden))
bnstd_running = torch.ones((1, n_hidden))
</code></pre></div>
These are not trained using backpropagation, these are trained using the update (janky update as sensei calls is, the one we made)
<div class="highlight"><pre><span></span><code>with torch.no_grad():
    bnmean_running = 0.999 * bnmean_running + 0.001 * bnmeani
    bnstd_running = 0.999 * bnstd_running + 0.001 * bnstdi
</code></pre></div></p>
</li>
<li>
<p>(i) These (above 2 points) are the parameters which calculate the mean and std of the activations, that are fed into the batch norm layer, over that batch -&gt; (ii) Then it is centering that batch to be unit gaussian and then it is offsetting and scaling it by the learned bias and gain -&gt; (iii) On top of that it is keeping track of the mean and std inputs and is maintaining the running mean and standard deviation (this will later be used as an inference so that we don't have to re-estimate the mean and std i.e. <code>bnmeani</code> and <code>bnstdi</code> all the time) and this allows us to basically forwards individual examples at test time.
<div class="highlight"><pre><span></span><code>  #----------------
  # BatchNorm layer
  #----------------
  bnmeani = hpreact.mean(0, keepdim=True) #(i)
  bnstdi = hpreact.std(0, keepdim=True) #(i)
  hpreact = bngain * (hpreact - bnmeani) / bnstdi + bnbias #(ii)
  with torch.no_grad(): #(iii)
    bnmean_running = 0.999 * bnmean_running + 0.001 * bnmeani #(iii)
    bnstd_running = 0.999 * bnstd_running + 0.001 * bnstdi #(iii)
  #----------------
</code></pre></div></p>
</li>
</ul>
</li>
</ul>
<p>( yes this is fairly a complicated layer, but this is what it is doing internally :) )</p>
<p>&nbsp;</p>
<h2 id="real-example-resnet50-walkthrough">Real example: resnet50 walkthrough<a class="headerlink" href="#real-example-resnet50-walkthrough" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-010450"><strong>Timestamp:</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=3890s">01:04:50</a><a class="headerlink" href="#timestamp-010450" title="Permanent link">&para;</a></h4>
<p>RESNET: Residual Neural Network commonly used for image classification.
Comparison of how the methodology implemented by us is almost similar to that in resnet implementation.</p>
<p>From <a href="https://youtu.be/P6sfmUTpUmc?si=guGsXV9IrWMdRkvX&amp;t=4280">1:11:20</a> -&gt; The comparison of batch norm: our implementation and in PyTorch.
See <a href="https://pytorch.org/docs/stable/generated/torch.nn.BatchNorm1d.html#batchnorm1d">PyTorch Documentation</a></p>
<p>&nbsp;</p>
<h2 id="summary-of-the-lecture">Summary of the lecture<a class="headerlink" href="#summary-of-the-lecture" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-011410"><strong>Timestamp:</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=4450s">01:14:10</a><a class="headerlink" href="#timestamp-011410" title="Permanent link">&para;</a></h4>
<p>Overall revision and finally with a note of advise to not use batch norm as there are many better normalization techniques available now.</p>
<h2 id="additional-summary">Additional Summary<a class="headerlink" href="#additional-summary" title="Permanent link">&para;</a></h2>
<h4 id="timestamp-011835-to-015134"><strong>Timestamp</strong> <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=4715s">01:18:35</a> to <a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=6694s">01:51:34</a> :<a class="headerlink" href="#timestamp-011835-to-015134" title="Permanent link">&para;</a></h4>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>He does a quick summary explanations of all the different sections of the codes. It will be a lot easier to follow from the video, here are the timestamps:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=4715s">01:18:35</a> just kidding: part2: PyTorch-ifying the code </li>
<li><a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=5211s">01:26:51</a> viz #1: forward pass activations statistics </li>
<li><a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=5454s">01:30:54</a> viz #2: backward pass gradient statistics </li>
<li><a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=5527s">01:32:07</a> the fully linear case of no non-linearities </li>
<li><a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=5775s">01:36:15</a> viz #3: parameter activation and gradient statistics </li>
<li><a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=5995s">01:39:55</a> viz #4: update:data ratio over time </li>
<li><a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=6364s">01:46:04</a> bringing back batchnorm, looking at the visualizations </li>
<li><a href="https://www.youtube.com/watch?v=P6sfmUTpUmc&amp;t=6694s">01:51:34</a> summary of the lecture for real this time</li>
</ul>
<p>Also, it was supposed to be a quick summary of what all we have done, as for those visualization graph, some may have been a little challenging to understand, but we will get into its depth in the next upcoming videos. So keep learning!</p>
</div>
<p><strong>The main 3 points discussed:</strong></p>
<ol>
<li>
<p>Introduction to Batch Norm, one of the first modern methods that were introduced to help stabilize training deep neural networks. How it works and How it will be used in a Neural Network.</p>
</li>
<li>
<p>PyTorch-ifying the code and writing it into modules/layers/classes -&gt; Linear, BatchNorm1d and tanh. These can be stacked up into neural nets like building blocks. So if you import <code>torch.nn</code> it will work here as well as the API calls are similar.</p>
</li>
<li>
<p>Introducing the dynamic tools that are used to understand if the neural network is in a good state dynamically.
    So we are looking at the statistics, histogram and activation of- <em>(graph 1)</em> the Forward pass activations, <em>(graph 2)</em> the Backward pass gradients and <em>(graph 3)</em> the ways it is going to get updated as part of the stochastic gradient descent (so we look at the mean, std and the ratio of the gradients to data) and <em>(graph 4)</em> finally the updates to the data (the final graph where we just compare it based on how it changes over time).</p>
</li>
</ol>
<p>Now, there are a lot things that haven't been explained as well. Right now we are actually getting to the cutting edge of where the field actually is. We certainly still haven't solved Initialization, Backpropagation - it's still under research but we are making progress and we have tools which are telling us if things are on the right track or not.</p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Makemore Part 3">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Makemore Part 3
              </div>
            </div>
          </a>
        
        
          
          <a href="../executed-starter-code/" class="md-footer__link md-footer__link--next" aria-label="Next: Starter Code">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Starter Code
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024-2025 Muhammed Muzzammil Shah
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://muhammedshah.com" target="_blank" rel="noopener" title="muhammedshah.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/muhammedshah" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/muzzammilshah" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.path", "navigation.sections", "navigation.footer", "search.highlight", "search.suggest", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>